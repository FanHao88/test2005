<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>品优购</title><link rel="shortcut icon" href=./favicon.ico><link rel=stylesheet href=../css/base.css><link rel=stylesheet href=../css/common.css><link rel=stylesheet href=../css/iconfont.css><link rel=stylesheet href=../css/index.css><link rel=stylesheet href=../css/car.css><script src=../lib/jquery-1.12.4.js></script><script src=../lib/swiper.min.js></script><script src=../js/index.js></script></head><body><div id=shortCuts><div class="shortCuts-container w"><div class=shortCuts-left><ul class=fl><li><span><i class=un-name></i>品优购欢迎您！</span></li><li><a href=javascript:;>请登录</a></li><li><a href=javascript:; class=style-red>免费注册</a></li></ul></div><div class=shortCuts-right><ul class=fr><li><a href=javascript:;>我的订单</a></li><span class=sr-solid></span><li><a href=javascript:;>我的品优购</a></li><i class="sr-triangle iconfont icon-down"></i> <span class=sr-solid></span><li><a href=javascript:;>品优购会员</a></li><span class=sr-solid></span><li><a href=javascript:;>企业采购</a></li><span class=sr-solid></span><li><a href=javascript:;>关注品优购</a></li><i class="sr-triangle iconfont icon-down"></i> <span class=sr-solid></span><li><a href=javascript:;>客户服务</a></li><i class="sr-triangle iconfont icon-down"></i> <span class=sr-solid></span><li><a href=javascript:;>网站导航</a></li><i class="sr-triangle iconfont icon-down"></i></ul></div></div></div><div id=header class=w><div class=h-logo><h1><a href=../index.html title=品优购>品优购</a></h1></div><div class=h-body><div class=h-search><input type=text value=热干面> <input type=submit value=搜索></div></div></div><div id=container><div class="con-body w"><table><thead><td><input type=checkbox class=c-input>&nbsp;&nbsp;全选</td><td>商品</td><td>单价&nbsp;(元)</td><td>数量</td><td>小计&nbsp;(元)</td><td>操作</td></thead><tbody><tr><td class=tb-title><p class=fl><input type=checkbox class=c-input>&nbsp;&nbsp;品优购自营</p><span class=fr>运费 ¥ 6:00</span></td><td class=tb-body><input type=checkbox class="c-input fl"> <img src=../images/aside_img.jpg alt="" class="fl car-img"><div class=car-id></div><p class=fl class=car-name>Apple苹果iPhone 6S Plus (A1699) 32G 金色 移动联通电信4G手机</p><span class="fl car-price">3739</span><div class="cb-num fl"><div class="cbn-left fl"><a href=javascript:;>-</a></div><div class="cbn-center fl car-num">1</div><div class="cbn-right fl"><a href=javascript:;>+</a></div></div><span class=fl>3799</span><div class="cb-del fl"><a href=javascript:; class=car-del>删除</a> <a href=javascript:;>移到我的关注</a></div></td></tr></tbody><tfoot><td class=fl><input type=checkbox>&nbsp;&nbsp;全选</td><td>总价：2000</td><td>结&nbsp;&nbsp;算</td></tfoot></table></div></div><div id=footer><div class="f-container w"><div class=fc-top><ul><li><h3 class=fl></h3><p class=fl>正品保障</p><span class=fl>正品保障，提供发票</span></li><li><h3 class=fl></h3><p class=fl>极速物流</p><span class=fl>极速物流，极速送达</span></li><li><h3 class=fl></h3><p class=fl>无忧售后</p><span class=fl>7天无理由退换货</span></li><li><h3 class=fl></h3><p class=fl>特色服务</p><span class=fl>私人订制家电套餐</span></li><li><h3 class=fl></h3><p class=fl>帮助中心</p><span class=fl>您的购物指南</span></li></ul></div><div class=fc-center><ul><li><ol><li><a href=javascript:;>购物指南</a></li><li><a href=javascript:;>购物流程</a></li><li><a href=javascript:;>会员介绍</a></li><li><a href=javascript:;>生活旅行/团购</a></li><li><a href=javascript:;>常见问题</a></li><li><a href=javascript:;>大家电</a></li><li><a href=javascript:;>联系客服</a></li></ol></li><li><ol><li><a href=javascript:;>配送方式</a></li><li><a href=javascript:;>上门自提</a></li><li><a href=javascript:;>211限时达</a></li><li><a href=javascript:;>配送服务查询</a></li><li><a href=javascript:;>配送费收取标准</a></li><li><a href=javascript:;>海外配送</a></li></ol></li><li><ol><li><a href=javascript:;>支付方式</a></li><li><a href=javascript:;>货到付款</a></li><li><a href=javascript:;>在线支付</a></li><li><a href=javascript:;>分期付款</a></li><li><a href=javascript:;>邮局汇款</a></li><li><a href=javascript:;>公司转账</a></li></ol></li><li><ol><li><a href=javascript:;>售后服务</a></li><li><a href=javascript:;>售后政策</a></li><li><a href=javascript:;>价格保护</a></li><li><a href=javascript:;>退款说明</a></li><li><a href=javascript:;>返修/退换卡</a></li><li><a href=javascript:;>取消订单</a></li></ol></li><li><ol><li><a href=javascript:;>特色服务</a></li><li><a href=javascript:;>夺宝岛</a></li><li><a href=javascript:;>DIY装机</a></li><li><a href=javascript:;>延保服务</a></li><li><a href=javascript:;>品优购E卡</a></li><li><a href=javascript:;>品优购通信</a></li></ol></li><li><ol><li><a href=javascript:;>购物指南</a></li><li class=erweima><img src=../images/erweima.png alt=""></li><li><a href=javascript:;>品优购客户端</a></li></ol></li></ul></div><div class=fc-bottom><ul><li><a href=javascript:;>关于我们</a></li><li><a href=javascript:;>联系我们</a></li><li><a href=javascript:;>联系客服</a></li><li><a href=javascript:;>商家入驻</a></li><li><a href=javascript:;>营销中心</a></li><li><a href=javascript:;>手机品优购</a></li><li><a href=javascript:;>友情链接</a></li><li><a href=javascript:;>销售联盟</a></li><li><a href=javascript:;>品优购社区</a></li><li><a href=javascript:;>品优购公益</a></li><li><a href=javascript:;>English Site</a></li><li><a href=javascript:;>Contact U</a></li></ul><p>互联网出版许可证编号新出网证(京)字150号|出版物经营许可证|网络文化经营许可证京网文[2014]2148-348号|违法和不良信息举报电话：4006561155</p><span>Copyright © 2004 - 2020 京东JD.com 版权所有|消费者维权热线：4006067733经营证照|(京)网械平台备字(2018)第00003号|营业执照</span></div></div></div><script>$(function() {
            // ==================与数据库相关操作================================

            // ==================自动创建购物车====================
            function showCart() {
                $.ajax({
                    url: '../interface/showlist.php',
                    dataType: 'json',
                    success: function(data) {
                        $('tbody').html("");
                        $.each(data.data, function(index, item) {
                            $('tbody').append(
                                `
                    <tr>
                        <td class="tb-title">
                            <p class="fl"><input type="checkbox" class="c-input">&nbsp;&nbsp;品优购自营</p>
                            <span class="fr">运费 ¥ 6:00</span>
                        </td>
                        <td class="tb-body">
                            <input type="checkbox" class="c-input fl">
                            <img src="${item.product_img}" alt="" class="fl car-img">
                            <div class="car-id">${item.product_id}</div>
                            <p class="fl" class="car-name">${item.product_name}</p>
                            <span class="fl car-price">${item.product_price}</span>
                            <div class="cb-num fl">
                                <div class="cbn-left fl"><a href="javascript:;">-</a></div>
                                <div class="cbn-center fl car-num">${item.product_num}</div>
                                <div class="cbn-right fl"><a href="javascript:;">+</a></div>
                            </div>
                            <span class="fl">${item.product_price*item.product_num}</span>
                            <div class="cb-del fl">
                                <a href="javascript:;" class="car-del">删除</a>
                                <a href="javascript:;">移到我的关注</a>
                            </div>
                        </td>
                    </tr>
                `
                            )
                        })
                    }
                });
            }
            showCart();

            // ==================删除数据信息======================
            $('tbody').on('click', '.car-del', function() {
                var id = $(this).parent().parent().children().eq(2).html();
                $.ajax({
                    url: '../interface/delwq.php',
                    dataType: 'json',
                    data: {
                        id: id
                    },
                    success: function(data) {
                        console.log(data)
                        if (data.code) {
                            showCart();
                        }
                    }
                })
            })

            // ==================增加数量======================
            $("tbody").on('click', '.cbn-right', (function() {
                $.ajax({
                    url: '../interface/updatawq.php',
                    dataType: 'json',
                    data: {
                        type: 'add',
                        id: $(this).parent().parent().children().eq(2).html(),
                    },
                })
            }))

            // ==================减少数量======================
            $("tbody").on('click', '.cbn-left', (function() {
                $.ajax({
                    url: '../interface/updatawq.php',
                    dataType: 'json',
                    data: {
                        type: 'reduce',
                        id: $(this).parent().parent().children().eq(2).html(),
                    },
                })
            }))

            // ==================获取传递过来的用户名=============

            $(".un-name").text(localStorage.getItem('un'))
            $(".un-name").css('color', 'red')

            //=================鼠标移入的效果  开始===============
            $("tbody").on('mouseover', '.tb-body', (function() {
                $(this).css("background", "#fdedee")
            }))
            $("tbody").on('mouseleave', '.tb-body', (function() {
                $(this).css("background", "#fff")
            }))
            $("tbody").on('mouseover', '.tb-title', (function() {
                $(this).css("background", "#fff")
            }))

            //=================鼠标移入的效果  结束===============


            //===================计算单商品的价格   开始===========
            $(".cb-num").next().text(function() {
                ($(this).prev().find(".cbn-center").text());
                ($(this).prev().prev().text());
                return $(this).prev().prev().text() * $(this).prev().find(".cbn-center").text()
            })

            $("tbody").on('click', '.cbn-left', (function() {
                var num = $(this).next().text();
                if (num == 0) {
                    return false;
                } else {
                    num--;
                    $(this).next().text(num);
                    let n = $(this).parent().prev().text() * num;
                    $(this).parent().next().text(n)
                    sum()
                }
            }))

            $("tbody").on('click', '.cbn-right', (function() {
                num = $(this).prev().text();
                num++;
                $(this).prev().text(num);
                let n = $(this).parent().prev().text() * num;
                $(this).parent().next().text(n)
                sum()
            }))

            //====================计算单商品的价格   结束==========


            //====================计算总价 开始===================
            var sum = function() {
                let sum = 0;
                $("tbody>tr>td>.cb-num").next().each(function(i, v) {
                    sum = sum + $(v).text() * 1;
                })
                return $("tfoot>tr>td:eq(1)").text("总价：" + sum);
            }
            sum()

            //====================计算总价 结束====================

        })</script></body></html>